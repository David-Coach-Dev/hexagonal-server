{
    "sourceFile": "control-panel/handler/response_handler.go",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1719210403414,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1719210410461,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,52 @@\n+package handler\r\n+\r\n+import (\r\n+    \"log\"\r\n+    \"net/http\"\r\n+    \"github.com/gin-gonic/gin\"\r\n+    \"control-panel/models\"\r\n+    \"context\"\r\n+)\r\n+\r\n+type ResponseHandler struct {\r\n+    monitorAdapter MonitorPort\r\n+    logsAdapter    LogsPort\r\n+}\r\n+\r\n+func NewResponseHandler(monitorAdapter MonitorPort, logsAdapter LogsPort) *ResponseHandler {\r\n+    return &ResponseHandler{\r\n+        monitorAdapter: monitorAdapter,\r\n+        logsAdapter:    logsAdapter,\r\n+    }\r\n+}\r\n+\r\n+func (rh *ResponseHandler) HandleResponse(c *gin.Context, data interface{}, err error, endpoint, usuario string) {\r\n+    ctx := context.Background()\r\n+    if err != nil {\r\n+        log := models.ErrorLog{\r\n+            ID:       \"0\",\r\n+            Fecha:    time.Now().Format(\"2006-01-02\"),\r\n+            Hora:     time.Now().Format(\"15:04:05\"),\r\n+            Endpoint: endpoint,\r\n+            Usuario:  usuario,\r\n+            Error:    err.Error(),\r\n+        }\r\n+        if saveErr := rh.logsAdapter.SaveLog(ctx, log); saveErr != nil {\r\n+            log.Println(\"Error saving log: \", saveErr)\r\n+        }\r\n+        c.JSON(http.StatusInternalServerError, gin.H{\"error\": err.Error()})\r\n+    } else {\r\n+        response := models.MonitorLog{\r\n+            ID:        \"0\",\r\n+            Fecha:     time.Now().Format(\"2006-01-02\"),\r\n+            Hora:      time.Now().Format(\"15:04:05\"),\r\n+            Endpoint:  endpoint,\r\n+            Usuario:   usuario,\r\n+            Respuesta: data,\r\n+        }\r\n+        if saveErr := rh.monitorAdapter.SaveLog(ctx, response); saveErr != nil {\r\n+            log.Println(\"Error saving monitor log: \", saveErr)\r\n+        }\r\n+        c.JSON(http.StatusOK, data)\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1719214109124,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,5 +49,4 @@\n         }\r\n         c.JSON(http.StatusOK, data)\r\n     }\r\n }\r\n-response_handler.go\n\\ No newline at end of file\n"
                },
                {
                    "date": 1719217375185,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n import (\r\n     \"log\"\r\n     \"net/http\"\r\n     \"github.com/gin-gonic/gin\"\r\n-    \"control-panel/models\"\r\n+    \"hexagonal-servercontrol-panel/models\"\r\n     \"context\"\r\n )\r\n \r\n type ResponseHandler struct {\r\n"
                }
            ],
            "date": 1719210403414,
            "name": "Commit-0",
            "content": "response_handler.go"
        }
    ]
}